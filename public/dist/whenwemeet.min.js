var wwm=function(){function o(o){wwm.model.initModule(),wwm.shell.initModule(o)}return{initModule:o}}();$(function(){wwm.initModule($("#whenwemeet"))}),wwm.model=function(){function o(){}return{initModule:o}}(),wwm.shell=function(){function o(o){t={$con:o,$view:o.find("#view"),$modal:o.find("#modal"),$kakaoLogin:o.find("#kakao-login-btn")}}function n(o,n,e,t,i){"string"==typeof o&&o.indexOf("Script error.")>-1||console.log("Error: ",o," Script: "+n+" Line: "+e+" Column: "+t+" StackTrace: "+i)}function e(e){console.log("login: "+localStorage.login),console.log("first: "+localStorage.first);{var l=localStorage.login&&JSON.parse(localStorage.login);localStorage.first&&JSON.parse(localStorage.first)}o(e),Kakao.init(i),console.log("logged: ",l),l?wwm.lobby.initModule(t.$view):(e.find("#view").html($("#wwm-login").html()),o(e),t.$kakaoLogin.on({click:function(){Kakao.Auth.login({success:function(o){Kakao.API.request({url:"/v1/user/me",success:function(o){localStorage.login=JSON.stringify(o),wwm.lobby.initModule(t.$view)},fail:function(o){alert(JSON.stringify(o))}})},fail:function(o){alert(JSON.stringify(o))}})},mouseover:function(){this.src="/kakao_account_login_btn_medium_narrow_ov.png"},mouseout:function(){this.src="/kakao_account_login_btn_medium_narrow.png"}})),$(window).on("error",n)}var t,i="a35623411563ec424430d3bd5dc7a93e";return{initModule:e}}(),wwm.lobby=function(){function o(o){c={$con:o,$showCreateroom:o.find("#show-createroom-modal"),$searchroomBtn:o.find("#searchroom-btn"),$list:o.find("#room-list"),$logout:o.find("#logout-btn"),$room:o.find(".room")}}function n(n){u=JSON.parse(localStorage.login),console.log("lobby",localStorage.login);var i=document.getElementById("wwm-lobby").textContent;console.log(i),console.log(u.properties.nickname),dust.renderSource(i,{name:u.properties.nickname},function(i,u){console.log(u),n.html(u),o(n),t(),c.$showCreateroom.click(e),c.$searchroomBtn.click(l),c.$logout.click(r),c.$room.click(a)})}function e(){wwm.modal.initModule($("#wwm-createroom"))}function t(){$.get("/roomlist").done(function(o){c.$list.html()})}function i(o){$(document.createDocumentFragment());c.$list.html()}function l(o){$.get("/search/"+o,function(o){i(o)})}function r(){localStorage.removeItem("login"),location.href="/logout"}function a(){wwm.room.initModule(c.$con)}var c,u;return{initModule:n}}(),wwm.modal=function(){function o(o){l.$modal.html(o),n(o),i.$close.click(e),l.$modal.show(),i.$createRoom.click(t)}function n(o){i={$con:o,$close:o.find(".modal-close"),$title:o.find("#room-title"),$number:o.find("#room-number"),$password:o.find("#room-password"),$createRoom:o.find("#create-room-btn")}}function e(){l.$modal.hide()}function t(){{var o,n=i.$title.val(),e=i.$number.val();i.$password.val()}return n?e?(o={title:i.$title.val(),number:i.$number.val(),password:i.$password.val()},void wwm.model.createRoom(o)):void alert("인원수를 선택하세요!"):void alert("제목을 입력하세요.")}var i,l={$modal:$("#modal")};return{initModule:o}}(),wwm.room=function(){function o(o){i={$con:o,$explode:o.find("#explode-room"),$ban:o.find("#ban-people-btn"),$changeNumber:o.find("#change-number-btn"),$changeTitle:o.find("#change-room-title"),$calendar:o.find("table")}}function n(){$(this).hasClass("busy")?(r.emit("not-busy",e(this)),$(this).removeClass("busy")):(r.emit("busy",e(this)),$(this).addClass("busy"))}function e(o){var n=[o.cellIndex,o.parentNode.rowIndex];return console.log("tableToArr",n),n}function t(e){l=JSON.parse(localStorage.login);var t=$("#wwm-room").text();dust.render(dust.loadSource(dust.compile(t)),{name:l.username},function(o,n){e.html(n)}),o(e),i.$calendar.find("td").click(n)}var i,l,r=io();return{initModule:t}}();